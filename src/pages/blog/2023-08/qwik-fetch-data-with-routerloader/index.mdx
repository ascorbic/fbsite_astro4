---
layout: ../../../../layouts/BlogPageLayout.astro
slug: '2023-08/qwik-fetch-data-with-routerloader'
title: Qwik - Fetch Data with routerLoader$
title1: Qwik Framework
title2: Fetch Data with routerLoader$
description: A Router Loader is  a strategy available in Qwik to execute async operation, for example to fetch data in the server and to consume them in any Qwik component.
author: ['Fabio Biondi']
image: 
  blur: "image.png"
  url: "image.png"
  alt: "Qwik emote"
pubDate: 2023-08-12
tags: ["qwik"]
series: 
  name: "Qwik Articles"
difficulty: 2
draft: false
---

import { Image } from 'astro:assets';

import * as ReactDOMServer from 'react-dom/server';
import Img from '@widgets/Image.astro';
import ImageCarousel from '@widgets/ImageCarousel.astro';
import HDivider from '@widgets/HDivider.astro';
import IFrame from '@widgets/IFrame.astro';
import Key from '@widgets/Key.astro';
import Code from '@widgets/Code.astro';
import Phone from '@widgets/Phone.astro';
import DesktopWindow from '@widgets/DesktopWindow.astro';
import Hero from '@widgets/PostHero.astro';
import PostSeries from '@widgets/PostSeries.astro';

import Hint from '@widgets/Hint.astro';
import StackBlitz from '@widgets/StackBlitz';

## TOPICS

# What is `routerLoader$`?

A [Router Loader](https://qwik.builder.io/docs/route-loader/) is  a strategy available in Qwik to execute async operation, for example to fetch data in the server and to consume them in any Qwik component.


# `routerLoader$` example

[Router Loader](https://qwik.builder.io/docs/route-loader/)s can only be declared in the `/routes` folder, in the `layout.tsx` file or in `index.`tsx files and they are triggered after a route change, so when users visit the page where they are used.
In this example you can see how we define a `routerLoader$` that is simply a function that fetch and return some data.

Any Qwik component, even children, can then import and use a `routeLoader$`, they will be automatically invoked when the page that contains them is mount.

Anyway the whole page will be rendered only when all async operations are completed.

<Code techs={['qwik', 'ts']} title="Router Loader example">
```tsx
export const useNews = routeLoader$(async () => {
  const res = await fetch('api/news');
  const users = await res.json();
  return users as User[];
});
```
</Code>

<Code techs={['qwik', 'ts']} title="Usage">
```tsx
export default component$( () => {
  const news = useNews();
  const projects = useProjects();
  const photos = usePhotos();

  return (
    <>
      <Information />
      <News data={news.value} />
      <Projects data={projects.value} />
      <Photos photo={photos.value }/>
    </>
  );
});
```
</Code>

# Rules

Some rules:

* So, as we said, they must be declared in layout tsx or index tsx
* a routerLoader can be used to get data from a database, by using a REST API, ORM (o er em) or SDK (es di key)
* Since they run on server they can cointains secret data such as API KEYS, TOKEN and so on and they won't be exposed on the client
* You can define multiple routerLoader in a file, and the page won't be rendered until all  are completed
* Data can be consumed by any Qwik Component


# How it works


So let's see how it works:

<Img isWindowed={false} src={import('./images/Qwik_slide.027.png')} w={960} quality={60} border/>

* We can declare one or more routerLoaders in  index or layout tsx files
* Any component can consume them
* the `routerLoader$` function is invoked on server...
* ...that can fetch data in several ways
* and the page (and its children) is rendered on server


# Animated Demo
So a component can consume mulitiple router loaders, all data is fetched on server and the page is rendered only when all loaders are completed.

<Img isWindowed={false} src={import('./images/how-it-works-animation.gif')} w={960} quality={60} border/>


# Video Tutorial

This content is also available as video tutorial:

<IFrame src="https://www.youtube.com/embed/QDpVCyLHNM8" />




<Hint title="Follow me for more tips" type="empty">
  Follow me on my [YouTube Channel](https://www.youtube.com/c/FabioBiondi) or on [LinkedIn](https://www.linkedin.com/in/fabiobiondi/) for more tips and tutorials about front-end topics
</Hint>


<PostSeries frontmatter={frontmatter} />
